function e(){return(e=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e}).apply(this,arguments)}class t{constructor(t){this.dispatch=t.dispatch,this.customPropertyNamespace=t.customPropertyNamespace,import("auth0-js").then(({WebAuth:r})=>{this.auth0=new r(e({},t))})}static addDefaultParams(t,r){return e({redirectUri:r+"/auth0_callback",audience:`https://${t.domain}/api/v2/`,responseType:"token id_token",scope:"openid profile email"},t)}authorize(){var e;null==(e=this.auth0)||e.authorize()}signup(){var e;null==(e=this.auth0)||e.authorize({mode:"signUp",screen_hint:"signup"})}logout(e){var t;null==(t=this.auth0)||t.logout({returnTo:e})}userId(e){return e.sub}userRoles(e){const t=e[(this.customPropertyNamespace+"/user_metadata").replace(/\/+user_metadata/,"/user_metadata")];return(null==t?void 0:t.roles)||null}async handleLoginCallback(){var e=this;return new Promise((t,r)=>{var s;null==(s=this.auth0)||s.parseHash(async function(r,s){r&&(e.dispatch("ERROR",{error:r,errorType:"authResult"}),t(!1));try{const r=await e.handleAuthResult(s);t(r)}catch(r){e.dispatch("ERROR",{error:r,errorType:"handleAuth"}),t(!1)}})})}async checkSession(){var e=this;return new Promise((t,r)=>{var s;null==(s=this.auth0)||s.checkSession({},async function(s,a){if(!s&&a&&a.accessToken&&a.idToken)try{const r=await e.fetchUser(a);t({user:r,authResult:a})}catch(e){r(e)}else r(s||new Error("Session invalid"))})})}async handleAuthResult(e){if(e&&e.accessToken&&e.idToken){const t=await this.fetchUser(e);return this.dispatch("AUTHENTICATED",{authResult:e,user:t}),!0}return!1}async fetchUser(e){return new Promise((t,r)=>{var s;null==(s=this.auth0)||s.client.userInfo((null==e?void 0:e.accessToken)||"",(e,s)=>{e?r(e):t(s)})})}}export{t as Auth0};
//# sourceMappingURL=auth0.modern.js.map
