var t=function(){function t(t){var n=this;this.dispatch=t.dispatch,import("netlify-identity-widget").then(function(e){n.netlifyIdentity=e.default,n.netlifyIdentity.init(t),n.netlifyIdentity.on("error",function(t){n.dispatch("ERROR",{error:t,errorType:"netlifyError"})}),n.netlifyIdentity.on("login",function(t){var e;n.dispatch("AUTHENTICATED",{user:t,authResult:{expiresIn:null==(e=t.token)?void 0:e.expires_in}})}),n.netlifyIdentity.on("init",function(t){var e;console.log("INIT",t),t&&(n.dispatch("LOGIN"),n.dispatch("AUTHENTICATED",{user:t,authResult:{expiresIn:null==(e=t.token)?void 0:e.expires_in}}))})})}t.addDefaultParams=function(t,n){return void 0===t&&(t={}),t};var n=t.prototype;return n.authorize=function(){this.dispatch("LOGIN"),this.netlifyIdentity.open("login")},n.signup=function(){this.dispatch("LOGIN"),this.netlifyIdentity.open("signup")},n.logout=function(t){this.netlifyIdentity.logout()},n.handleLoginCallback=function(t){try{return console.warn("handleLoginCallback is unnecessary with Netlify Identity Widget"),Promise.resolve(!0)}catch(t){return Promise.reject(t)}},n.checkSession=function(){try{var t=this,n=function(n){var e,i=t.netlifyIdentity.currentUser();if(i)return{user:i,authResult:{expiresIn:null==(e=i.token)?void 0:e.expires_in}};throw new Error("Session invalid")},e=function(n,e){try{var i=Promise.resolve(t.netlifyIdentity.refresh()).then(function(){})}catch(t){return e()}return i&&i.then?i.then(void 0,e):i}(0,function(){throw new Error("Session invalid")});return Promise.resolve(e&&e.then?e.then(n):n())}catch(t){return Promise.reject(t)}},n.userId=function(t){return t.id},n.userRoles=function(t){return[t.role]||null},t}();export{t as NetlifyIdentity};
//# sourceMappingURL=NetlifyIdentity.esm.js.map
