!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).reactUseAuth={})}(this,function(e){function t(){return(t=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function n(e,t){try{var n=e()}catch(e){return t(e)}return n&&n.then?n.then(void 0,t):n}var r=function(){function e(e){var n=this;this.dispatch=e.dispatch,this.customPropertyNamespace=e.customPropertyNamespace,import("auth0-js").then(function(r){n.auth0=new(0,r.WebAuth)(t({},e))})}e.addDefaultParams=function(e,n){return t({redirectUri:n+"/auth0_callback",audience:"https://"+e.domain+"/api/v2/",responseType:"token id_token",scope:"openid profile email"},e)};var r=e.prototype;return r.authorize=function(){var e;null==(e=this.auth0)||e.authorize()},r.signup=function(){var e;null==(e=this.auth0)||e.authorize({mode:"signUp",screen_hint:"signup"})},r.logout=function(e){var t;null==(t=this.auth0)||t.logout({returnTo:e})},r.userId=function(e){return e.sub},r.userRoles=function(e){var t=e[(this.customPropertyNamespace+"/user_metadata").replace(/\/+user_metadata/,"/user_metadata")];return(null==t?void 0:t.roles)||null},r.handleLoginCallback=function(){try{var e=this;return Promise.resolve(new Promise(function(t,r){var i;null==(i=e.auth0)||i.parseHash(function(r,i){try{r&&(e.dispatch("ERROR",{error:r,errorType:"authResult"}),t(!1));var o=n(function(){return Promise.resolve(e.handleAuthResult(i)).then(function(e){t(e)})},function(n){e.dispatch("ERROR",{error:n,errorType:"handleAuth"}),t(!1)});return Promise.resolve(o&&o.then?o.then(function(){}):void 0)}catch(e){return Promise.reject(e)}})}))}catch(e){return Promise.reject(e)}},r.checkSession=function(){try{var e=this;return Promise.resolve(new Promise(function(t,r){var i;null==(i=e.auth0)||i.checkSession({},function(i,o){try{var u=function(){if(!i&&o&&o.accessToken&&o.idToken){var u=n(function(){return Promise.resolve(e.fetchUser(o)).then(function(e){t({user:e,authResult:o})})},function(e){r(e)});if(u&&u.then)return u.then(function(){})}else r(i||new Error("Session invalid"))}();return Promise.resolve(u&&u.then?u.then(function(){}):void 0)}catch(e){return Promise.reject(e)}})}))}catch(e){return Promise.reject(e)}},r.handleAuthResult=function(e){try{var t=this;return e&&e.accessToken&&e.idToken?Promise.resolve(t.fetchUser(e)).then(function(n){return t.dispatch("AUTHENTICATED",{authResult:e,user:n}),!0}):Promise.resolve(!1)}catch(e){return Promise.reject(e)}},r.fetchUser=function(e){try{var t=this;return Promise.resolve(new Promise(function(n,r){var i;null==(i=t.auth0)||i.client.userInfo((null==e?void 0:e.accessToken)||"",function(e,t){e?r(e):n(t)})}))}catch(e){return Promise.reject(e)}},e}(),i=function(){function e(e){var t=this;this.dispatch=e.dispatch,import("netlify-identity-widget").then(function(n){t.netlifyIdentity=n.default,t.netlifyIdentity.init(e),t.netlifyIdentity.on("error",function(e){t.dispatch("ERROR",{error:e,errorType:"netlifyError"})}),t.netlifyIdentity.on("login",function(e){var n;t.dispatch("AUTHENTICATED",{user:e,authResult:{expiresIn:null==(n=e.token)?void 0:n.expires_in}})}),t.netlifyIdentity.on("init",function(e){var n;console.log("INIT",e),e&&(t.dispatch("LOGIN"),t.dispatch("AUTHENTICATED",{user:e,authResult:{expiresIn:null==(n=e.token)?void 0:n.expires_in}}))})})}e.addDefaultParams=function(e,t){return void 0===e&&(e={}),e};var t=e.prototype;return t.authorize=function(){this.dispatch("LOGIN"),this.netlifyIdentity.open("login")},t.signup=function(){this.dispatch("LOGIN"),this.netlifyIdentity.open("signup")},t.logout=function(e){this.netlifyIdentity.logout()},t.handleLoginCallback=function(e){try{return console.warn("handleLoginCallback is unnecessary with Netlify Identity Widget"),Promise.resolve(!0)}catch(e){return Promise.reject(e)}},t.checkSession=function(){try{var e=this,t=function(t){var n,r=e.netlifyIdentity.currentUser();if(r)return{user:r,authResult:{expiresIn:null==(n=r.token)?void 0:n.expires_in}};throw new Error("Session invalid")},n=function(t,n){try{var r=Promise.resolve(e.netlifyIdentity.refresh()).then(function(){})}catch(e){return n()}return r&&r.then?r.then(void 0,n):r}(0,function(){throw new Error("Session invalid")});return Promise.resolve(n&&n.then?n.then(t):t())}catch(e){return Promise.reject(e)}},t.userId=function(e){return e.id},t.userRoles=function(e){return[e.role]||null},e}();e.Auth0=r,e.NetlifyIdentity=i});
//# sourceMappingURL=providers.umd.js.map
